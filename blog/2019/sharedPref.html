<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>Afonso Raposo | Flutter: How to Save Objects in SharedPreferences</title>
<meta name="description" content="Personal website.
">

<!-- Open Graph -->

<meta property="og:site_name" content="Personal website.
" />
<meta property="og:type" content="object" />
<meta property="og:title" content="" />
<meta property="og:url" content="https://afonsoraposo.com/blog/2019/sharedPref" />
<meta property="og:description" content="Flutter: How to Save Objects in SharedPreferences" />
<meta property="og:image" content="https://github.com/Afonsocraposo/afonsocraposo.github.io/raw/master/assets/img/coding.jpg" />


<!-- Bootstrap & MDB -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

<!-- Fonts & Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

<!-- Code Syntax Highlighting -->
<link rel="stylesheet" href="https://gitcdn.link/repo/jwarby/jekyll-pygments-themes/master/github.css" />

<!-- Styles -->

<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üë®üèª‚Äçüíª</text></svg>">

<link rel="stylesheet" href="/assets/css/main.css">

<link rel="canonical" href="/blog/2019/sharedPref">

<!-- JQuery -->
<!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>


<!-- Theming-->

  <script src="/assets/js/theme.js"></script>
  <!-- Load DarkMode JS -->
<script src="/assets/js/dark_mode.js"></script>






    
<!-- MathJax -->
<script type="text/javascript">
  window.MathJax = {
    tex: {
      tags: 'ams'
    }
  };
</script>
<script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js"></script>
<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>


  </head>

  <body class="fixed-top-nav sticky-bottom-footer">

    <!-- Header -->

    <header>

    <!-- Nav Bar -->
    <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
    <div class="container">
      
      <a class="navbar-brand title font-weight-lighter" href="https://afonsoraposo.com/">
       Afonso Raposo
      </a>
      
      <!-- Navbar Toggle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>
      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/">
              About
              
            </a>
          </li>
          
          <!-- Blog -->
          <li class="nav-item active">
            <a class="nav-link" href="/blog/">
              Blog
              
            </a>
          </li>
          
          <!-- Other pages -->
          
          
          
          
          
          
          
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/projects/">
                Projects
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/publications/">
                Publications
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/teaching/">
                Teaching
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/assets/pdf/CV_Afonso_Raposo.pdf">
                cv
                
              </a>
          </li>
          
          
          
            <div class = "toggle-container">
              <a id = "light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
              </a>
            </div>
          
        </ul>
      </div>
    </div>
  </nav>

</header>


    <!-- Content -->

    <div class="container mt-5">
      

<div class="post">

  <header class="post-header">
    <h1 class="post-title">Flutter: How to Save Objects in SharedPreferences</h1>
    <p class="post-meta">September 7, 2019</p>
  </header>

  <article class="post-content">
    <div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        <img class="img-fluid rounded z-depth-1" src="/assets/img/posts/2019-09-07-sharedPref/header.jpeg" />
    </div>
</div>
<p><br /></p>

<p>While developing a mobile application, you may want to save a custom object for later use, for example, saving a user‚Äôs info when the application is closed and using it when the app is opened later.</p>

<p>To do so, we‚Äôll encode our object into a JSON string and save it in the <code class="language-plaintext highlighter-rouge">SharedPreferences</code> space. When we want to read the saved data, we only have to decode from a JSON string back to our object. Saving data in <code class="language-plaintext highlighter-rouge">SharedPreferences</code> is an easy solution when you want to save small amounts of data.</p>

<center>
<h1>
. . .
</h1>
</center>

<h1 id="create-a-custom-object"><strong>Create a Custom Object</strong></h1>

<p>For our example, we‚Äôll use a very simple object to store some user information.</p>

<p>Our object will have three attributes: name, age, and location; each one represented by a string.</p>

<p>Our class is really simple. In our example, it‚Äôs initiated as an object with null attributes and each one is assigned later.</p>

<figure class="highlight"><pre><code class="language-dart" data-lang="dart"><span class="kd">class</span> <span class="nc">User</span> <span class="p">{</span>
  <span class="kt">String</span> <span class="n">name</span><span class="p">;</span>
  <span class="kt">String</span> <span class="n">age</span><span class="p">;</span>
  <span class="kt">String</span> <span class="n">location</span><span class="p">;</span>

  <span class="n">User</span><span class="p">();</span>

  <span class="p">...</span>
  
<span class="p">};</span></code></pre></figure>

<center>
<h1>
. . .
</h1>
</center>

<h1 id="json-encode-and-decode"><strong>JSON: Encode and Decode</strong></h1>

<p>To encode our user object into JSON, we must create a function inside the class that will do this conversion. It will create a map where each attribute (value) corresponds to a key:</p>

<figure class="highlight"><pre><code class="language-dart" data-lang="dart"><span class="kt">Map</span><span class="p">&lt;</span><span class="kt">String</span><span class="p">,</span> <span class="kd">dynamic</span><span class="p">&gt;</span> <span class="n">toJson</span><span class="p">()</span> <span class="o">=</span><span class="p">&gt;</span> <span class="p">{</span>
  <span class="s">'name'</span><span class="o">:</span> <span class="n">name</span><span class="p">,</span>
  <span class="s">'age'</span><span class="o">:</span> <span class="n">age</span><span class="p">,</span>
  <span class="s">'location'</span><span class="o">:</span> <span class="n">location</span><span class="p">,</span>
<span class="p">};</span></code></pre></figure>

<p>This will convert our user object into a <code class="language-plaintext highlighter-rouge">Map&lt;String, dynamic&gt;</code>. To convert it to a JSON string, late we‚Äôll later have to use the function <code class="language-plaintext highlighter-rouge">json.encode(Map&lt;String, dynamic&gt;)</code>. This will convert our user object to a JSON string like:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{"name":"Alfonso","age":"21","location":"Portugal"}
</code></pre></div></div>

<p>This string will be saved in the <code class="language-plaintext highlighter-rouge">SharedPreferences</code>.
<br /></p>

<p>To decode from a JSON string to a user object, we must first use the function <code class="language-plaintext highlighter-rouge">json.decode(JSON-String)</code>. This will return a <code class="language-plaintext highlighter-rouge">Map&lt;String, dynamic&gt;</code> which we can then convert into our user object:</p>

<figure class="highlight"><pre><code class="language-dart" data-lang="dart"><span class="n">User</span><span class="o">.</span><span class="na">fromJson</span><span class="p">(</span><span class="kt">Map</span><span class="p">&lt;</span><span class="kt">String</span><span class="p">,</span> <span class="kd">dynamic</span><span class="p">&gt;</span> <span class="n">json</span><span class="p">)</span>
    <span class="o">:</span> <span class="n">name</span> <span class="o">=</span> <span class="n">json</span><span class="p">[</span><span class="s">'name'</span><span class="p">],</span>
      <span class="n">age</span> <span class="o">=</span> <span class="n">json</span><span class="p">[</span><span class="s">'age'</span><span class="p">],</span>
      <span class="n">location</span> <span class="o">=</span> <span class="n">json</span><span class="p">[</span><span class="s">'location'</span><span class="p">];</span></code></pre></figure>

<p>Therefore, the final code for our user class will be:</p>

<figure class="highlight"><pre><code class="language-dart" data-lang="dart"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="code"><pre><span class="kd">class</span> <span class="nc">User</span> <span class="p">{</span>
  <span class="kt">String</span> <span class="n">name</span><span class="p">;</span>
  <span class="kt">String</span> <span class="n">age</span><span class="p">;</span>
  <span class="kt">String</span> <span class="n">location</span><span class="p">;</span>

  <span class="n">User</span><span class="p">();</span>

  <span class="n">User</span><span class="o">.</span><span class="na">fromJson</span><span class="p">(</span><span class="kt">Map</span><span class="p">&lt;</span><span class="kt">String</span><span class="p">,</span> <span class="kd">dynamic</span><span class="p">&gt;</span> <span class="n">json</span><span class="p">)</span>
      <span class="o">:</span> <span class="n">name</span> <span class="o">=</span> <span class="n">json</span><span class="p">[</span><span class="s">'name'</span><span class="p">],</span>
        <span class="n">age</span> <span class="o">=</span> <span class="n">json</span><span class="p">[</span><span class="s">'age'</span><span class="p">],</span>
        <span class="n">location</span> <span class="o">=</span> <span class="n">json</span><span class="p">[</span><span class="s">'location'</span><span class="p">];</span>

  <span class="kt">Map</span><span class="p">&lt;</span><span class="kt">String</span><span class="p">,</span> <span class="kd">dynamic</span><span class="p">&gt;</span> <span class="n">toJson</span><span class="p">()</span> <span class="o">=</span><span class="p">&gt;</span> <span class="p">{</span>
        <span class="s">'name'</span><span class="o">:</span> <span class="n">name</span><span class="p">,</span>
        <span class="s">'age'</span><span class="o">:</span> <span class="n">age</span><span class="p">,</span>
        <span class="s">'location'</span><span class="o">:</span> <span class="n">location</span><span class="p">,</span>
      <span class="p">};</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></figure>

<center>
<h1>
. . .
</h1>
</center>

<h1 id="sharedpreferences-save-and-read"><strong>SharedPreferences: Save and Read</strong></h1>

<p>First, in order to use the <code class="language-plaintext highlighter-rouge">SharedPreferences</code>, we have to use Flutter‚Äôs plugin for it. To do so, make sure <code class="language-plaintext highlighter-rouge">dependencies</code> in your <code class="language-plaintext highlighter-rouge">pubspec.yaml</code> file looks similar to this:</p>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="na">dependencies</span><span class="pi">:</span>
  <span class="s">...</span>
  <span class="s">shared_preferences</span><span class="err">:</span> <span class="s">any</span></code></pre></figure>

<p>To save (write) something in <code class="language-plaintext highlighter-rouge">SharedPreferences</code>, we must provide a value that we want to save and a key that identifies it.</p>

<p>In our case, the value will be a string‚Äîthe key is always a string.</p>

<p>The first thing we have to do is <code class="language-plaintext highlighter-rouge">getInstance</code> of the <code class="language-plaintext highlighter-rouge">SharedPreferences</code>:</p>

<figure class="highlight"><pre><code class="language-dart" data-lang="dart"><span class="kd">final</span> <span class="n">prefs</span> <span class="o">=</span> <span class="k">await</span> <span class="n">SharedPreferences</span><span class="o">.</span><span class="na">getInstance</span><span class="p">();</span></code></pre></figure>

<p>Here, the code await will hold the program‚Äôs execution until we have the <code class="language-plaintext highlighter-rouge">SharedPreferences</code> instance. If you don‚Äôt understand asynchronous programming very well, you can read more about it in the Dart documentation.</p>

<p>After having the <code class="language-plaintext highlighter-rouge">SharedPreferences</code> instance, we‚Äôll want to save the string value with a given key:</p>

<figure class="highlight"><pre><code class="language-dart" data-lang="dart"><span class="n">prefs</span><span class="o">.</span><span class="na">setString</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span></code></pre></figure>

<p>Remember that the value we want to save is a custom object, therefore, we need to encode it into a JSON string, as explained above. The code then becomes:</p>

<figure class="highlight"><pre><code class="language-dart" data-lang="dart"><span class="n">prefs</span><span class="o">.</span><span class="na">setString</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">json</span><span class="o">.</span><span class="na">encode</span><span class="p">(</span><span class="n">value</span><span class="p">));</span></code></pre></figure>

<p>Our <code class="language-plaintext highlighter-rouge">write</code> method will be:</p>

<figure class="highlight"><pre><code class="language-dart" data-lang="dart"><span class="kd">static</span> <span class="nf">write</span><span class="p">(</span><span class="kt">String</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="kd">async</span> <span class="p">{</span>
  <span class="kd">final</span> <span class="n">prefs</span> <span class="o">=</span> <span class="k">await</span> <span class="n">SharedPreferences</span><span class="o">.</span><span class="na">getInstance</span><span class="p">();</span>
  <span class="k">return</span> <span class="k">await</span> <span class="n">prefs</span><span class="o">.</span><span class="na">setString</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">json</span><span class="o">.</span><span class="na">encode</span><span class="p">(</span><span class="n">value</span><span class="p">));</span>
<span class="p">}</span></code></pre></figure>

<div class="caption">
    Give special attention to the fact that the function is "async".
</div>

<p>The <code class="language-plaintext highlighter-rouge">read</code> method is similar to the <code class="language-plaintext highlighter-rouge">write</code> one and its code is the following:</p>

<figure class="highlight"><pre><code class="language-dart" data-lang="dart"><span class="kd">static</span> <span class="nf">read</span><span class="p">(</span><span class="kt">String</span> <span class="n">key</span><span class="p">)</span> <span class="kd">async</span> <span class="p">{</span>
  <span class="kd">final</span> <span class="n">SharedPreferences</span> <span class="n">prefs</span> <span class="o">=</span> <span class="k">await</span> <span class="n">SharedPreferences</span><span class="o">.</span><span class="na">getInstance</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">prefs</span><span class="o">.</span><span class="na">containsKey</span><span class="p">(</span><span class="n">key</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="na">decode</span><span class="p">(</span><span class="n">prefs</span><span class="o">.</span><span class="na">getString</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<div class="caption">
    Here we must check if the key exists and then decode the stored String (JSON string).
</div>

<p>Prior, we should have organized every function used to manage the <code class="language-plaintext highlighter-rouge">SharedPreferences</code> in a class called <code class="language-plaintext highlighter-rouge">SharedPref</code>. The code is:</p>

<figure class="highlight"><pre><code class="language-dart" data-lang="dart"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td><td class="code"><pre><span class="kn">import</span> <span class="s">'package:shared_preferences/shared_preferences.dart'</span><span class="o">;</span>
<span class="kn">import</span> <span class="s">'dart:convert'</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">SharedPref</span> <span class="p">{</span>
  <span class="kd">static</span> <span class="n">read</span><span class="p">(</span><span class="kt">String</span> <span class="n">key</span><span class="p">)</span> <span class="kd">async</span> <span class="p">{</span>
    <span class="kd">final</span> <span class="n">SharedPreferences</span> <span class="n">prefs</span> <span class="o">=</span> <span class="k">await</span> <span class="n">SharedPreferences</span><span class="o">.</span><span class="na">getInstance</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">prefs</span><span class="o">.</span><span class="na">containsKey</span><span class="p">(</span><span class="n">key</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="na">decode</span><span class="p">(</span><span class="n">prefs</span><span class="o">.</span><span class="na">getString</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="kd">static</span> <span class="n">write</span><span class="p">(</span><span class="kt">String</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="kd">async</span> <span class="p">{</span>
    <span class="kd">final</span> <span class="n">prefs</span> <span class="o">=</span> <span class="k">await</span> <span class="n">SharedPreferences</span><span class="o">.</span><span class="na">getInstance</span><span class="p">();</span>
    <span class="k">return</span> <span class="k">await</span> <span class="n">prefs</span><span class="o">.</span><span class="na">setString</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">json</span><span class="o">.</span><span class="na">encode</span><span class="p">(</span><span class="n">value</span><span class="p">));</span>
  <span class="p">}</span>

  <span class="kd">static</span> <span class="n">remove</span><span class="p">(</span><span class="kt">String</span> <span class="n">key</span><span class="p">)</span> <span class="kd">async</span> <span class="p">{</span>
    <span class="kd">final</span> <span class="n">prefs</span> <span class="o">=</span> <span class="k">await</span> <span class="n">SharedPreferences</span><span class="o">.</span><span class="na">getInstance</span><span class="p">();</span>
    <span class="n">prefs</span><span class="o">.</span><span class="na">remove</span><span class="p">(</span><span class="n">key</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="kd">static</span> <span class="n">clear</span><span class="p">()</span> <span class="kd">async</span> <span class="p">{</span>
    <span class="kd">final</span> <span class="n">prefs</span> <span class="o">=</span> <span class="k">await</span> <span class="n">SharedPreferences</span><span class="o">.</span><span class="na">getInstance</span><span class="p">();</span>
    <span class="n">prefs</span><span class="o">.</span><span class="na">clear</span><span class="p">();</span>
  <span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></figure>

<div class="caption">
    Also added the "remove" and "clear" methods.
</div>

<center>
<h1>
. . .
</h1>
</center>

<h1 id="demo-use-it-in-an-app"><strong>Demo: Use it in an App</strong></h1>

<p>Since the <code class="language-plaintext highlighter-rouge">SharedPref</code> methods are static, we can save a user object to our <code class="language-plaintext highlighter-rouge">SharedPreferences</code> very simply:</p>

<figure class="highlight"><pre><code class="language-dart" data-lang="dart"><span class="n">SharedPref</span><span class="o">.</span><span class="na">save</span><span class="p">(</span><span class="s">"user"</span><span class="p">,</span> <span class="n">userSave</span><span class="p">);</span></code></pre></figure>

<p>The tricky part of using this method for saving objects in a real app is retrieving the object itself, and not a <code class="language-plaintext highlighter-rouge">Future&lt;Dynamic&gt;</code>. The trick is having an asynchronous function in our app that will retrieve our object and update the application‚Äôs state when it‚Äôs ready.</p>

<p>The function will look something like:</p>

<figure class="highlight"><pre><code class="language-dart" data-lang="dart"><span class="n">loadSharedPrefs</span><span class="p">()</span> <span class="kd">async</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="n">User</span> <span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="na">fromJson</span><span class="p">(</span><span class="k">await</span> <span class="n">SharedPref</span><span class="o">.</span><span class="na">read</span><span class="p">(</span><span class="s">"user"</span><span class="p">));</span>
    <span class="n">setState</span><span class="p">(()</span> <span class="p">{</span>
      <span class="n">userLoad</span> <span class="o">=</span> <span class="n">user</span><span class="p">;</span>
    <span class="p">});</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">Excepetion</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// do something</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>As before, the <code class="language-plaintext highlighter-rouge">await</code> will make sure that the function‚Äôs execution is on hold until we retrieved the value corresponding to the key ‚Äúuser‚Äù from the <code class="language-plaintext highlighter-rouge">SharedPreferences</code>. After it, we create a user object from the retrieved JSON string and update our application‚Äôs <code class="language-plaintext highlighter-rouge">State</code>.</p>

<p>I created a simple demo application to showcase all the above. Here is a gif of the app in action:</p>

<div class="row mt-3">
    <div class="col-sm mt-3 pt-md-0 pl-xl-5 pr-xl-5">
    <div class="col-sm mt-3 pt-md-0 pl-xl-5 pr-xl-5">
    <div class="col-sm mt-3 pt-md-0 pl-xl-5 pr-xl-5">
    <div class="col-sm mt-3 pt-md-0 pl-xl-5 pr-xl-5">
        <img class="img-fluid rounded z-depth-1" src="/assets/img/posts/2019-09-07-sharedPref/application.gif" />
    </div>
    </div>
    </div>
    </div>

</div>
<p><br /></p>

<p>And here is the code:</p>

<figure class="highlight"><pre><code class="language-dart" data-lang="dart"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
</pre></td><td class="code"><pre><span class="kn">import</span> <span class="s">'package:flutter/material.dart'</span><span class="o">;</span>
<span class="kn">import</span> <span class="s">'SharedPref.dart'</span><span class="o">;</span>
<span class="kn">import</span> <span class="s">'user.dart'</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">Demo</span> <span class="kd">extends</span> <span class="n">StatefulWidget</span> <span class="p">{</span>
  <span class="nd">@override</span>
  <span class="n">DemoView</span> <span class="n">createState</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">DemoView</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">DemoView</span> <span class="kd">extends</span> <span class="n">State</span><span class="p">&lt;</span><span class="n">Demo</span><span class="p">&gt;</span> <span class="p">{</span>
  <span class="n">SharedPref</span> <span class="n">sharedPref</span> <span class="o">=</span> <span class="n">SharedPref</span><span class="p">();</span>
  <span class="n">User</span> <span class="n">userSave</span> <span class="o">=</span> <span class="n">User</span><span class="p">();</span>
  <span class="n">User</span> <span class="n">userLoad</span> <span class="o">=</span> <span class="n">User</span><span class="p">();</span>

  <span class="n">loadSharedPrefs</span><span class="p">()</span> <span class="kd">async</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
      <span class="n">User</span> <span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="na">fromJson</span><span class="p">(</span><span class="k">await</span> <span class="n">SharedPref</span><span class="o">.</span><span class="na">read</span><span class="p">(</span><span class="s">"user"</span><span class="p">));</span>
      <span class="n">Scaffold</span><span class="o">.</span><span class="na">of</span><span class="p">(</span><span class="n">context</span><span class="p">)</span><span class="o">.</span><span class="na">showSnackBar</span><span class="p">(</span><span class="n">SnackBar</span><span class="p">(</span>
          <span class="nl">content:</span> <span class="k">new</span> <span class="n">Text</span><span class="p">(</span><span class="s">"Loaded!"</span><span class="p">),</span>
          <span class="nl">duration:</span> <span class="kd">const</span> <span class="n">Duration</span><span class="p">(</span><span class="nl">milliseconds:</span> <span class="mi">500</span><span class="p">)));</span>
      <span class="n">setState</span><span class="p">(()</span> <span class="p">{</span>
        <span class="n">userLoad</span> <span class="o">=</span> <span class="n">user</span><span class="p">;</span>
      <span class="p">});</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">Excepetion</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">Scaffold</span><span class="o">.</span><span class="na">of</span><span class="p">(</span><span class="n">context</span><span class="p">)</span><span class="o">.</span><span class="na">showSnackBar</span><span class="p">(</span><span class="n">SnackBar</span><span class="p">(</span>
          <span class="nl">content:</span> <span class="k">new</span> <span class="n">Text</span><span class="p">(</span><span class="s">"Nothing found!"</span><span class="p">),</span>
          <span class="nl">duration:</span> <span class="kd">const</span> <span class="n">Duration</span><span class="p">(</span><span class="nl">milliseconds:</span> <span class="mi">500</span><span class="p">)));</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="nd">@override</span>
  <span class="n">Widget</span> <span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span> <span class="n">context</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">ListView</span><span class="p">(</span>
      <span class="nl">children:</span> <span class="p">&lt;</span><span class="n">Widget</span><span class="p">&gt;[</span>
        <span class="n">Container</span><span class="p">(</span>
          <span class="nl">height:</span> <span class="mf">200.0</span><span class="p">,</span>
          <span class="nl">child:</span> <span class="n">Column</span><span class="p">(</span>
            <span class="nl">mainAxisAlignment:</span> <span class="n">MainAxisAlignment</span><span class="o">.</span><span class="na">spaceEvenly</span><span class="p">,</span>
            <span class="nl">children:</span> <span class="p">&lt;</span><span class="n">Widget</span><span class="p">&gt;[</span>
              <span class="n">Container</span><span class="p">(</span>
                  <span class="nl">height:</span> <span class="mf">50.0</span><span class="p">,</span>
                  <span class="nl">width:</span> <span class="mf">300.0</span><span class="p">,</span>
                  <span class="nl">child:</span> <span class="n">TextField</span><span class="p">(</span>
                    <span class="nl">decoration:</span> <span class="n">InputDecoration</span><span class="p">(</span><span class="nl">hintText:</span> <span class="s">"Name"</span><span class="p">),</span>
                    <span class="nl">onChanged:</span> <span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="p">{</span>
                      <span class="n">setState</span><span class="p">(()</span> <span class="p">{</span>
                        <span class="n">userSave</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
                      <span class="p">});</span>
                    <span class="p">},</span>
                  <span class="p">)),</span>
              <span class="n">Container</span><span class="p">(</span>
                  <span class="nl">height:</span> <span class="mf">50.0</span><span class="p">,</span>
                  <span class="nl">width:</span> <span class="mf">300.0</span><span class="p">,</span>
                  <span class="nl">child:</span> <span class="n">TextField</span><span class="p">(</span>
                    <span class="nl">decoration:</span> <span class="n">InputDecoration</span><span class="p">(</span><span class="nl">hintText:</span> <span class="s">"Age"</span><span class="p">),</span>
                    <span class="nl">onChanged:</span> <span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="p">{</span>
                      <span class="n">setState</span><span class="p">(()</span> <span class="p">{</span>
                        <span class="n">userSave</span><span class="o">.</span><span class="na">age</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
                      <span class="p">});</span>
                    <span class="p">},</span>
                  <span class="p">)),</span>
              <span class="n">Container</span><span class="p">(</span>
                  <span class="nl">height:</span> <span class="mf">50.0</span><span class="p">,</span>
                  <span class="nl">width:</span> <span class="mf">300.0</span><span class="p">,</span>
                  <span class="nl">child:</span> <span class="n">TextField</span><span class="p">(</span>
                    <span class="nl">decoration:</span> <span class="n">InputDecoration</span><span class="p">(</span><span class="nl">hintText:</span> <span class="s">"Location"</span><span class="p">),</span>
                    <span class="nl">onChanged:</span> <span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="p">{</span>
                      <span class="n">setState</span><span class="p">(()</span> <span class="p">{</span>
                        <span class="n">userSave</span><span class="o">.</span><span class="na">location</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
                      <span class="p">});</span>
                    <span class="p">},</span>
                  <span class="p">)),</span>
            <span class="p">],</span>
          <span class="p">),</span>
        <span class="p">),</span>
        <span class="n">Container</span><span class="p">(</span>
          <span class="nl">height:</span> <span class="mf">80.0</span><span class="p">,</span>
          <span class="nl">child:</span> <span class="n">Row</span><span class="p">(</span>
            <span class="nl">mainAxisAlignment:</span> <span class="n">MainAxisAlignment</span><span class="o">.</span><span class="na">spaceEvenly</span><span class="p">,</span>
            <span class="nl">children:</span> <span class="p">&lt;</span><span class="n">Widget</span><span class="p">&gt;[</span>
              <span class="n">RaisedButton</span><span class="p">(</span>
                <span class="nl">onPressed:</span> <span class="p">()</span> <span class="p">{</span>
                  <span class="n">SharedPref</span><span class="o">.</span><span class="na">save</span><span class="p">(</span><span class="s">"user"</span><span class="p">,</span> <span class="n">userSave</span><span class="p">);</span>
                  <span class="n">Scaffold</span><span class="o">.</span><span class="na">of</span><span class="p">(</span><span class="n">context</span><span class="p">)</span><span class="o">.</span><span class="na">showSnackBar</span><span class="p">(</span><span class="n">SnackBar</span><span class="p">(</span>
                      <span class="nl">content:</span> <span class="k">new</span> <span class="n">Text</span><span class="p">(</span><span class="s">"Saved!"</span><span class="p">),</span>
                      <span class="nl">duration:</span> <span class="kd">const</span> <span class="n">Duration</span><span class="p">(</span><span class="nl">milliseconds:</span> <span class="mi">500</span><span class="p">)));</span>
                <span class="p">},</span>
                <span class="nl">child:</span> <span class="n">Text</span><span class="p">(</span><span class="s">'Save'</span><span class="p">,</span> <span class="nl">style:</span> <span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span> <span class="mi">20</span><span class="p">)),</span>
              <span class="p">),</span>
              <span class="n">RaisedButton</span><span class="p">(</span>
                <span class="nl">onPressed:</span> <span class="p">()</span> <span class="p">{</span>
                  <span class="n">loadSharedPrefs</span><span class="p">();</span>
                <span class="p">},</span>
                <span class="nl">child:</span> <span class="n">Text</span><span class="p">(</span><span class="s">'Load'</span><span class="p">,</span> <span class="nl">style:</span> <span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span> <span class="mi">20</span><span class="p">)),</span>
              <span class="p">),</span>
              <span class="n">RaisedButton</span><span class="p">(</span>
                <span class="nl">onPressed:</span> <span class="p">()</span> <span class="p">{</span>
                  <span class="n">SharedPref</span><span class="o">.</span><span class="na">remove</span><span class="p">(</span><span class="s">"user"</span><span class="p">);</span>
                  <span class="n">Scaffold</span><span class="o">.</span><span class="na">of</span><span class="p">(</span><span class="n">context</span><span class="p">)</span><span class="o">.</span><span class="na">showSnackBar</span><span class="p">(</span><span class="n">SnackBar</span><span class="p">(</span>
                      <span class="nl">content:</span> <span class="k">new</span> <span class="n">Text</span><span class="p">(</span><span class="s">"Cleared!"</span><span class="p">),</span>
                      <span class="nl">duration:</span> <span class="kd">const</span> <span class="n">Duration</span><span class="p">(</span><span class="nl">milliseconds:</span> <span class="mi">500</span><span class="p">)));</span>
                  <span class="n">setState</span><span class="p">(()</span> <span class="p">{</span>
                    <span class="n">userLoad</span> <span class="o">=</span> <span class="n">User</span><span class="p">();</span>
                  <span class="p">});</span>
                <span class="p">},</span>
                <span class="nl">child:</span> <span class="n">Text</span><span class="p">(</span><span class="s">'Clear'</span><span class="p">,</span> <span class="nl">style:</span> <span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span> <span class="mi">20</span><span class="p">)),</span>
              <span class="p">),</span>
            <span class="p">],</span>
          <span class="p">),</span>
        <span class="p">),</span>
        <span class="n">SizedBox</span><span class="p">(</span>
          <span class="nl">height:</span> <span class="mf">300.0</span><span class="p">,</span>
          <span class="nl">child:</span> <span class="n">Column</span><span class="p">(</span>
            <span class="nl">crossAxisAlignment:</span> <span class="n">CrossAxisAlignment</span><span class="o">.</span><span class="na">center</span><span class="p">,</span>
            <span class="nl">mainAxisAlignment:</span> <span class="n">MainAxisAlignment</span><span class="o">.</span><span class="na">spaceEvenly</span><span class="p">,</span>
            <span class="nl">children:</span> <span class="p">&lt;</span><span class="n">Widget</span><span class="p">&gt;[</span>
              <span class="n">Text</span><span class="p">(</span><span class="s">"Name: "</span> <span class="o">+</span> <span class="p">(</span><span class="n">userLoad</span><span class="o">.</span><span class="na">name</span> <span class="o">??</span> <span class="s">""</span><span class="p">),</span>
                  <span class="nl">style:</span> <span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span> <span class="mi">16</span><span class="p">)),</span>
              <span class="n">Text</span><span class="p">(</span><span class="s">"Age: "</span> <span class="o">+</span> <span class="p">(</span><span class="n">userLoad</span><span class="o">.</span><span class="na">age</span> <span class="o">??</span> <span class="s">""</span><span class="p">),</span>
                  <span class="nl">style:</span> <span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span> <span class="mi">16</span><span class="p">)),</span>
              <span class="n">Text</span><span class="p">(</span><span class="s">"Location: "</span> <span class="o">+</span> <span class="p">(</span><span class="n">userLoad</span><span class="o">.</span><span class="na">location</span> <span class="o">??</span> <span class="s">""</span><span class="p">),</span>
                  <span class="nl">style:</span> <span class="n">TextStyle</span><span class="p">(</span><span class="nl">fontSize:</span> <span class="mi">16</span><span class="p">)),</span>
            <span class="p">],</span>
          <span class="p">),</span>
        <span class="p">),</span>
      <span class="p">],</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></figure>


  </article>

  
    <div id="disqus_thread"></div>
    <script type="text/javascript">
      var disqus_shortname  = 'afonso';
      var disqus_identifier = '/blog/2019/sharedPref';
      var disqus_title      = "Flutter: How to Save Objects in SharedPreferences";
      (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  

</div>

    </div>

    <!-- Footer -->

    
<footer class="sticky-bottom mt-5">
  <div class="container">
    &copy; Copyright 2022 Afonso  Raposo.
    Powered by <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank">GitHub Pages</a>.

    
    
    Last updated: October 17, 2022.
    
  </div>
</footer>



  </body>

  <!-- Bootsrap & MDB scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js" integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A==" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js" integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script>

  
<!-- Mansory & imagesLoaded -->
<script defer src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
<script defer src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
<script defer src="/assets/js/mansory.js" type="text/javascript"></script>


  


<!-- Load Common JS -->
<script src="/assets/js/common.js"></script>


</html>
